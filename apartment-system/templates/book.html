<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>จองห้อง {{.room.RoomNumber}}</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script>
function updateEndDate() {
    const start = document.getElementById('start_date').value;
    const months = parseInt(document.getElementById('months').value);
    if (!start || !months) return;

    const startDate = new Date(start);
    const endDate = new Date(startDate.setMonth(startDate.getMonth() + months));
    
    const yyyy = endDate.getFullYear();
    const mm = String(endDate.getMonth() + 1).padStart(2, '0');
    const dd = String(endDate.getDate()).padStart(2, '0');
    
    document.getElementById('end_date').value = `${yyyy}-${mm}-${dd}`;
}
</script>
</head>
<body>
<div class="container mt-4">
  <h2>จองห้อง {{.room.RoomNumber}}</h2>
  <div class="card p-3 mb-3">
    <img src="/uploads/{{.room.Image}}" class="img-fluid mb-3" style="max-width:300px;">
    <p>ขนาด: {{.room.Size}}</p>
    <p>ราคา: {{.room.Price}} บาท/เดือน</p>
  </div>
  
 <form action="/book" method="POST">
  <input type="hidden" name="room_id" value="{{.room.ID}}">
  <input type="hidden" name="end_date" id="end_date">

  <div class="mb-3">
    <label class="form-label">ชื่อผู้จอง</label>
    <input type="text" name="name" class="form-control" required>
  </div>

  <div class="mb-3">
    <label class="form-label">เบอร์โทร</label>
    <input type="tel" name="phone" class="form-control" placeholder="08x-xxx-xxxx" required>
  </div>

  <div class="mb-3">
    <label class="form-label">วันเริ่มเช่า</label>
    <input type="date" id="start_date" name="start_date" class="form-control" required onchange="updateEndDate()">
  </div>

  <div class="mb-3">
    <label class="form-label">จำนวนเดือน (1–12)</label>
    <select id="months" name="months" class="form-select" onchange="updateEndDate()">
      {{ range seq 1 12 }}
      <option value="{{.}}">{{.}} เดือน</option>
      {{ end }}
    </select>
  </div>

  <button type="submit" class="btn btn-success">จองห้อง</button>
  <a href="/" class="btn btn-secondary">กลับ</a>
</form>

</div>
</body>
</html>
